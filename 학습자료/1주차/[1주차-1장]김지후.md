# 1주차 (1장 JPA 소개)

JPA를 이용하면 SQL 쿼리 없이 데이터베이스 데이터를 다룰 수 있습니다. 이는 JPA가 개발자 대신 SQL을 생성하고 관리해주기 때문입니다.

즉, 자바 ORM(Object-Relational Mapping) 표준 JPA를 사용하면 SQL 작성 없이 객체를 데이터베이스에 직접 저장할 수 있게 도와주고 객체와 관계형 데이터베이스의 차이도 중간에서 해결할 수 있다.

> ORM : ORM이란 객체 지향 프로그래밍 언어와 관계형 데이터베이스 간의 호환되지 않는 데이터를 매핑하는 프로그래밍 기법을 말합니다. 즉, 객체를 통해 간접적으로 데이터베이스에 접근하도록 도와주는 도구입니다.

> JPA : JPA(Java Persistence API)는 자바에서 제공하는 ORM(Object-Relational Mapping) 기술의 표준입니다.

JPA를 사용해서 엔터프라이즈 애플리케이션(대규모 기업이나 조직에서 운영되는 서비스)을 개발하려면, `자바 언어`와 `JDBC`를 사용한 `데이터베이스 프로그래밍`, `객체지향 프로그래밍`과 `관계형 데이터베이스`에 대해서 알고있어야한다. 추가로 `웹 개발`과 `스프링 프레임워크에 대한 기초지식`, `JUnit`을 다룰 수 있어야 한다.

김영한 저자의 `자바 ORM 표준 JPA 프로그래밍`을 통해서 JPA를 통한 웹 애플리케이션(웹 브라우저를 통해 접근하고 사용할 수 있는 애플리케이션 소프트웨어) 개발에 대해서 학습해보자.

# 1장 JPA 소개

> 비생산적인 반복적인 SQL 작성을 해결하기 위해 ORM 등장(ORM 표준인 JPA)

- 객체 중심 개발로 인한 생산성과 유지보수 좋아짐
- 테스트 작성 편리(버그 줄어듦)
- 데이터베이스를 쉽게 변경

하이버네이트는 JPA 스펙을 구현한 라이브러리 중 하나이다. 즉, 하이버네이트는 JPA의 표준 스펙을 준수하면서, 추가적인 기능을 제공한다.

JPA는 인터페이스의 집합으로, 자바 객체와 관계형 데이터베이스 사이의 매핑을 정의한다.

(객체와 관계형 데이터베이스 사이에는 어떤 차이가 있는지 알아보자.)

### 객체와 관계형 데이터베이스

> 관계형 데이터베이스는 대중적이고 신뢰할만한 안전한 데이터 저장소이다.

- 자바로 개발하는 애플리케이션은 대부분 관계형 데이터베이스를 데이터 저장소로 사용한다.
- 데이터베이스의 데이터를 관리하려면 SQL을 사용해야한다.
- 자바로 작성한 애플리케이션은 JDBC API를 사용해서 SQL을 데이터베이스에 전달한다.

> 객체와 관계형 데이터베이스는 데이터를 구조화하고 저장하는 두 가지 다른 방법입니다. 이 둘 사이의 주요 차이점은 데이터를 표현하는 방식과 그에 따른 데이터 조작 방법입니다.

- 객체(Object): 객체는 속성(데이터)과 메서드(함수)를 포함하는 개체로, 객체 지향 프로그래밍에서 사용됩니다. 객체는 실제 세계의 항목을 모델링하며, 상속, 캡슐화, 다형성 등의 특징을 가집니다. 예를 들어, '사람'이라는 객체가 있을 때 '이름', '나이', '성별' 등의 속성과 '걷다', '뛰다', '먹다' 등의 메서드를 가질 수 있습니다.
- 관계형 데이터베이스(Relational Database): 관계형 데이터베이스는 데이터를 테이블의 형태로 저장합니다. 각 테이블은 여러 개의 열(column)과 행(row)을 가지며, 데이터는 이 테이블의 셀에 저장됩니다. 테이블 간의 관계를 통해 데이터를 연결하고 조작할 수 있습니다.

>

객체와 관계형 데이터베이스 사이에는 '객체-관계 불일치'라는 문제가 있습니다. 즉, 객체 지향 프로그래밍 언어에서 사용하는 `객체의 구조`와 관계형 데이터베이스에서 사용하는 `테이블의 구조`가 서로 일치하지 않는다는 문제입니다. 이 문제를 해결하기 위해 ORM(Object-Relational Mapping)이라는 기술이 사용됩니다. ORM은 객체와 관계형 데이터베이스 사이의 불일치를 해결해주는 역할을 합니다.

## 1.1 SQL을 직접 다룰 때 발생하는 문제점

※ But, SQL은 다룰줄 알아야한다.

JDBC API를 사용해 SQL을 데이터베이스에 전달하는 방식으로 개발을 진행한다고 가정하고 SQL을 직접 다룰 때의 문제점에 대해서 알아보자.

> 데이터베이스는 객체 구조와는 다른 데이터 중심의 구조를 가지므로 객체를 데이터베이스에 직접 저장하거나 조회할 수 없다.
>
> > 따라서 개발자가 객체지향 애플리케이션과 데이터베이스 중간에서 SQL과 JDBC API를 사용해서 변환 작업을 직접 해주어야 한다.

> 객체를 데이터베이스에 CRUD하려면 너무 많은 SQL과 JDBC API를 코드로 작성해야한다. ex:) 테이블이 100개라면 100번 반복..

### SQL에 의존할 때의 문제점

SQL에 과도하게 의존하는 개발 방식은 몇 가지 문제점이 있다.

> 데이터베이스 종속성: SQL은 데이터베이스 관리 시스템(DBMS (ex: Oracle, MySQL)에 따라서 문법이나 기능이 약간씩 다르기 때문에, 특정 DBMS의 SQL에 의존적인 코드를 작성하면, 다른 DBMS로의 이전이 어렵게 된다. 이는 특히 시스템이 커지면 커질수록 문제가 될 수 있다.

- 객체 지향 프로그래밍과의 불일치: SQL은 관계형 데이터 모델에 기반하고 있지만, 대부분의 현대 언어들은 객체 지향 프로그래밍(OOP) 모델을 사용한다. 이 두 모델 간의 차이는 "객체-관계 불일치" 문제를 일으키며, 이를 해결하기 위해 많은 노력이 필요하다.
- 유지보수의 어려움: SQL 쿼리가 복잡해질수록 이해하거나 수정하는 것이 어려워진다. 특히 SQL 쿼리가 여러 곳에 분산되어 있으면, 일관성을 유지하거나 버그를 찾는 것이 더욱 어려워진다.
- 보안 문제: SQL 쿼리를 잘못 구성하면 SQL Injection 같은 보안 취약점이 발생할 수 있다.

위와 같은 문제들 때문에, SQL에 너무 의존하지 않고, ORM(Object-Relational Mapping) 도구를 사용하는 것이 좋을 수 있다. ORM 도구는 객체-관계 불일치 문제를 해결해주고, DBMS에 독립적인 코드를 작성할 수 있게 해주며, SQL Injection과 같은 보안 문제를 방지하는 등의 이점을 제공합니다.

### JPA와 문제 해결

> JPA를 사용하면 객체를 데이터베이스에 저장하고 관리할 때, 개발자가 직접 SQL을 작성하는 것이 아니라 JPA가 제공하는 API를 사용하면 된다.
> 그러면 개발자 대신에 적절한 SQL을 생성해서 데이터베이스에 전달한다.

### 저장 (Create)

```java
jpa.persist(member); // 저장

```

이 메서드를 호출하면 JPA가 객체와 매핑정보를 보고 적절한 INSERT SQL을 생성해서 데이터베이스에 전달한다.

### 연관된 객체 조회

```java
Member member = jpa.find(Member.class, memberId);
Team team = member.getTeam(); // 연관된 객체 조회

```

JPA는 연관된 객체를 사용하는 시점에 적절한 SELECT SQL을 실행한다.

따라서 JPA를 사용하면 연관된 객체를 마음껏 조회할 수 있다.

## 1.2 패러다임의 불일치

> 객체와 관계형 데이터베이스는 지향하는 목적이 다르므로 둘의 기능과 표현 방법도 다르다. 이것을 객체와 관계형 데이터베이스의 패러다임 불일치 문제라 한다.
>
> > 따라서 객체 구조를 테이블 구조에 저장하는 데는 한계가 있다.

객체지향 프로그래밍은 추상화, 캡슐화, 정보은닉, 상속, 다형성 등 시스템의 복잡성을 제어할 수 있는 다양한 장치들을 제공한다.

그래서 현대의 복잡한 애플리케이션은 대부분 객체지향 언어로 개발한다.

객체가 단순하면 객체의 모든 속성 값을 꺼내서 파일이나 데이터베이스에 저장하면 되지만, 부모 객체를 상속받았거나, 다른 객체를 참조하고 있다면 객체의 상태를 저장하기가 쉽지 않다.

예를 들어 회원 객체를 저장해야 하는데 회원 객체가 팀 객체를 참조하고 있다면, 회원 객체를 저장할 때 팀 객체를 잃어버리는 문제가 발생한다.

`상속`, `연관관계`, `객체그래프탐색`, `비교`

---

## 1.3 JPA란 무엇인가?

> Spring의 DB 접근 기술은 순수 JDBC -> 스프링 JDBC Template -> JPA -> Spring Data JPA 순으로 발전했다.

- JPA가 등장하기 전에는 JDBC를 사용해 SQL 쿼리를 작성해야만 데이터베이스에 접근이 가능했다.
- JPA가 등장하면서 기존의 JDBC 방식보다 더 객체지향적인 접근을 가능하게 됐다.

> Spring Data JPA는 JPA를 편리하게 사용하도록 도와주는 기술이다.

JPA (Java Persistence API)는 자바 진영의 ORM 기술 표준이다.

애플리케이션과 JDBC 사이에서 동작한다.

> JPA : JPA(Java Persistence API)는 자바에서 제공하는 ORM(Object-Relational Mapping) 기술의 표준입니다.
>
> !https://velog.velcdn.com/images/jihukimme/post/12bff82d-e633-41fa-be55-0af43a188c93/image.jpeg

> ORM : ORM이란 객체 지향 프로그래밍 언어와 관계형 데이터베이스 간의 호환되지 않는 데이터를 매핑하는 프로그래밍 기법을 말합니다. 즉, 객체를 통해 간접적으로 데이터베이스에 접근하도록 도와주는 도구입니다.
>
> !https://velog.velcdn.com/images/jihukimme/post/68c95864-760f-4feb-b106-b4942c63658d/image.jpeg

> ORM 프레임워크를 사용하면 객체를 데이터베이스에 저장할 때 INSERT SQL을 직접 작성하는 것이 아니라 객체를 마치 자바 컬렉션에 저장하듯이 ORM 프레임워크에 저장하면 된다.
> 그러면 ORM 프레임워크가 적절한 INSERT SQL을 생성해서 데이터베이스에 객체를 저장해준다.

- 즉, JPA를 사용하면 이전의 JDBC가 갖고있던 단점인 `반복적인 SQL 쿼리 작성`, `패러다임 불일치` 등을 해결할 수 있다.
  !https://velog.velcdn.com/images/jihukimme/post/4cccb08a-7b1f-4020-89e6-84d9ca10c616/image.jpeg

따라서 객체 측면에서는 정교한 객체 모델링을 할 수 있고 관계형 데이터베이스는 데이터베이스에 맞도록 모델링하면 된다.

그리고 둘을 어떻게 매핑해야 하는지 매핑 방법만 ORM 프레임워크에게 알려주면된다.

덕분에 개발자는 데이터 중심인 관계형 데이터베이스를 사용해도 객체지향 애플리케이션 개발에 집중할 수 있다.
